//
//  VulnerabilityTypes.swift
//  Allsafe-iOS
//
//  Created by Krist√≥f on 2025. 08. 05..
//

import Foundation

enum VulnerabilityType: String, CaseIterable, Identifiable {
    case userDefaults = "userdefaults"
    case keychain = "keychain"
    case plist = "plist"
    case fileSystem = "filesystem"
    case sqliteDb = "sqlite"
    case licenseKey = "licensekey"
    case jailbreak = "jailbreak"
    case sslPinning = "sslpinning"
    case webviewXSS = "webviewxss"
    case logging = "logging"
    case pinbruteforce = "pinbruteforce"
    case hardcodedsecrets = "hardcodedsecrets"
    case insecurefilesharing = "insecurefilesharing"
    
    var id: String { rawValue }
    
    var title: String {
        switch self {
        case .userDefaults:
            return "NSUserDefaults Storage"
        case .keychain:
            return "Keychain Misuse"
        case .fileSystem:
            return "NSURLSession Cache"
        case .sqliteDb:
            return "SQLite Database"
        case .plist:
            return "Property List Files"
        case .licenseKey:
            return "License Key Validation"
        case .jailbreak:
            return "Jailbreak Detection"
        case .sslPinning:
            return "SSL Pinning Bypass"
        case .webviewXSS:
            return "WebView XSS Injection"
        case .logging:
            return "Insecure Logging"
        case .pinbruteforce:
            return "Vulnerable Vault"
        case .hardcodedsecrets:
            return "Hardcoded Secrets"
        case .insecurefilesharing:
            return "Insecure File Sharing"
        }
    }
    
    var description: String {
        switch self {
        case .userDefaults:
            return "Sensitive data stored in NSUserDefaults"
        case .keychain:
            return "Improper keychain implementation"
        case .fileSystem:
            return "Sensitive data cached in NSURLSession"
        case .sqliteDb:
            return "Unencrypted SQLite databases"
        case .plist:
            return "Secrets in property list files"
        case .licenseKey:
            return "Bypass license key validation using Frida"
        case .jailbreak:
            return "Perform a jailbreak detection on the device"
        case .sslPinning:
            return "Bypass SSL Pinning checks using Frida"
        case .webviewXSS:
            return "Exploit XSS vulnerabilities in WebView components"
        case .logging:
            return "Find the insecurely logged secret"
        case .pinbruteforce:
            return "Brute-force your way into the vault"
        case .hardcodedsecrets:
            return "Find the secrets and decrypt the flag"
        case .insecurefilesharing:
            return "Excessive sharing is bad"
        }
    }
    
    var icon: String {
        switch self {
        case .userDefaults:
            return "gear"
        case .keychain:
            return "key"
        case .fileSystem:
            return "folder"
        case .sqliteDb:
            return "cylinder"
        case .plist:
            return "doc.text"
        case .licenseKey:
            return "checkmark.seal"
        case .jailbreak:
            return "lock.shield"
        case .sslPinning:
            return "shield"
        case .webviewXSS:
            return "globe"
        case .logging:
            return "terminal"
        case .pinbruteforce:
            return "lock.fill"
        case .hardcodedsecrets:
            return "eye.slash"
        case .insecurefilesharing:
            return "square.and.arrow.up.trianglebadge.exclamationmark.fill"
        }
    }
    
    var difficulty: String {
        switch self {
        case .userDefaults:
            return "Easy"
        case .keychain:
            return "Easy"
        case .fileSystem:
            return "Medium"
        case .plist:
            return "Easy"
        case .sqliteDb:
            return "Medium"
        case .licenseKey:
            return "Hard"
        case .jailbreak:
            return "Medium"
        case .sslPinning:
            return "Medium"
        case .webviewXSS:
            return "Easy"
        case .logging:
            return "Easy"
        case .pinbruteforce:
            return "Hard"
        case .hardcodedsecrets:
            return "Medium"
        case .insecurefilesharing:
            return "Easy"
        }
    }
}
